"use strict";(globalThis["webpackChunkmaghfirah"]=globalThis["webpackChunkmaghfirah"]||[]).push([[86],{3086:(e,t,a)=>{a.r(t),a.d(t,{default:()=>$});var l=a(9835),s=a(6970);const o=(0,l._)("div",{class:"q-pb-sm"},null,-1);function i(e,t,a,i,r,h){const n=(0,l.up)("s-loading"),d=(0,l.up)("q-tab"),u=(0,l.up)("q-tabs"),b=(0,l.up)("s-top-table"),p=(0,l.up)("q-td"),m=(0,l.up)("s-table-option"),g=(0,l.up)("q-img"),c=(0,l.up)("q-table"),w=(0,l.up)("FormModal"),y=(0,l.up)("Detail"),f=(0,l.up)("t-modal"),$=(0,l.up)("s-drawer");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(n,{load:r.loading},null,8,["load"]),(0,l.Wm)($,{wrapCard:"",onRefresh:h.refresh,Meta:r.Meta,filter:r.filter,table:r.table,modelValue:r.filter.query,"onUpdate:modelValue":[t[12]||(t[12]=e=>r.filter.query=e),h.refresh]},{default:(0,l.w5)((()=>[o,"admin"===e.$Handle.getLS("role").slug?((0,l.wg)(),(0,l.j4)(u,{key:0,modelValue:r.tab,"onUpdate:modelValue":t[2]||(t[2]=e=>r.tab=e),"inline-label":"","outside-arrows":"","mobile-arrows":"",class:"bg-primary text-white shadow-2",style:{"border-radius":"10px 10px 0 0"}},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"All",name:null,noCaps:"",onClick:t[0]||(t[0]=e=>h.getData())}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.Meta.group,(e=>((0,l.wg)(),(0,l.j4)(d,{key:e,name:e,label:e,noCaps:"",onClick:t[1]||(t[1]=e=>h.getData())},null,8,["name","label"])))),128))])),_:1},8,["modelValue"])):((0,l.wg)(),(0,l.j4)(u,{key:1,modelValue:r.tab,"onUpdate:modelValue":t[5]||(t[5]=e=>r.tab=e),"inline-label":"","outside-arrows":"","mobile-arrows":"",class:"bg-primary text-white shadow-2",style:{"border-radius":"10px 10px 0 0"}},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"All",name:null,noCaps:"",onClick:t[3]||(t[3]=e=>h.getData())}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.group,(e=>((0,l.wg)(),(0,l.j4)(d,{key:e,name:e.group,label:e.group,noCaps:"",onClick:t[4]||(t[4]=e=>h.getData())},null,8,["name","label"])))),128))])),_:1},8,["modelValue"])),(0,l.Wm)(c,{"virtual-scroll":"",class:"q-my-sm",rows:r.table.rows,columns:r.table.columns,"row-key":"id",selection:"multiple",selected:r.table.selected,"onUpdate:selected":t[8]||(t[8]=e=>r.table.selected=e),pagination:r.table.pagination,"onUpdate:pagination":t[9]||(t[9]=e=>r.table.pagination=e),style:(0,s.j5)(e.$Static.table.height()),dense:e.$Static.table.dense(),flat:e.$Static.table.flat(),color:e.$Static.table.color(),"rows-per-page-label":e.$Static.table.rowPerPageLabel(),"rows-per-page-options":e.$Static.table.rowPerPageOption(),square:e.$Static.table.square(),bordered:e.$Static.table.bordered(),"binary-state-sort":"","visible-columns":r.table.visibleColumns,onRequest:h.getData,loading:r.loading,filter:r.table.search,separator:e.$Static.table.separator()},{top:(0,l.w5)((()=>[(0,l.Wm)(b,{Meta:r.Meta,table:r.table,modelValue:r.table.search,"onUpdate:modelValue":t[6]||(t[6]=e=>r.table.search=e),onDelete:h.daleteData,trash:r.trash,onTrash:h.setTrash,onRestore:h.restoreData,onAdd:h.addData,onSeachReset:t[7]||(t[7]=e=>r.table.search=null),onOnFilter:h.setFilter,filter:r.filter},null,8,["Meta","table","modelValue","onDelete","trash","onTrash","onRestore","onAdd","onOnFilter","filter"])])),"body-cell-id":(0,l.w5)((e=>[1==r.trash?((0,l.wg)(),(0,l.j4)(p,{key:0})):((0,l.wg)(),(0,l.j4)(m,{key:1,onShow:t=>h.detail(e.key),onEdit:t=>h.edit(e.key),Meta:r.Meta},null,8,["onShow","onEdit","Meta"]))])),"body-cell-photo_id":(0,l.w5)((t=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[t&&t.row&&t.row.photo&&t.row.photo.path?((0,l.wg)(),(0,l.j4)(g,{key:0,src:e.$System.storageUrl(t.row.photo.name),style:{width:"100px",height:"100px"}},null,8,["src"])):(0,l.kq)("",!0)])),_:2},1024)])),_:1},8,["rows","columns","selected","pagination","style","dense","flat","color","rows-per-page-label","rows-per-page-options","square","bordered","visible-columns","onRequest","loading","filter","separator"]),(0,l.Wm)(f,{modelValue:r.modal,"onUpdate:modelValue":t[11]||(t[11]=e=>r.modal=e),onSubmit:h.submit},{default:(0,l.w5)((()=>["form"==r.modalType?((0,l.wg)(),(0,l.j4)(w,{key:0,modal:r.useModal,id:r.id,submitOnModal:r.submitOnModal,onCloseModal:t[10]||(t[10]=e=>r.modal=!r.modal),onRefresh:h.refresh},null,8,["modal","id","submitOnModal","onRefresh"])):((0,l.wg)(),(0,l.j4)(y,{key:1,modal:r.useModal,id:r.id},null,8,["modal","id"]))])),_:1},8,["modelValue","onSubmit"])])),_:1},8,["onRefresh","Meta","filter","table","modelValue","onUpdate:modelValue"])])}a(9665);var r=a(1939),h=a(6262),n=a(8479);const d={name:r.Z.name,components:{FormModal:h["default"],Detail:n["default"]},data(){return{Meta:r.Z,id:null,table:r.Z.table,useModal:r.Z.formType,loading:!1,modal:!1,trash:!1,modalType:"",submitOnModal:null,filter:{value:!1,query:null},tab:null,group:[]}},created(){console.log(this.$route.query.tab),this.table=this.$Handle.structureTable(this.table.columns(this.$route.query.tab)),this.getContentsGroup(),this.$route.query.tab&&(this.tab=this.$route.query.tab),this.$route.query.trash&&(this.trash=JSON.parse(this.$route.query.trash)),this.$route.query.search&&(this.trash=JSON.parse(this.$route.query.search)),this.$route.query.page&&(this.table.pagination={...this.$route.query}),this.refresh()},methods:{refresh(){this.getData()},getData(e){this.loading=!0,e&&(this.table.pagination=e.pagination);let{page:t,rowsPerPage:a,sortBy:l,descending:s}={...this.table.pagination},o=this.Meta.module+"?table=";this.tab&&(o+="&where=group:"+this.tab),o+="&like="+this.$Help.transformQuery(this.filter.query),o+=this.trash?"&trash=true":"",o+="&page="+t,o+="&limit="+a,o+="&order="+this.$Handle.transformDesc(l,s),this.table.search&&(o+="&search="+this.table.search),this.$api.get(o,((e,t,a,l)=>{200==t&&(this.table.rows=e.data.filter((e=>this.trash&&this.table.search?null!==e.deleted_at:e)),this.table.pagination.rowsNumber=this.table.search?this.table.rows.length:e.total,this.table.pagination.page=e.current_page,this.table.pagination.rowsPerPage=e.per_page,this.loading=!1,this.table.columns=this.Meta.table.columns(this.tab))}),(e=>{})),this.$router.replace({query:{...this.table.pagination,seach:this.table.search,trash:this.trash,tab:this.tab}})},async daleteData(){this.loading=!0,await this.table.selected.forEach((e=>{let t=this.Meta.module;t+=1==this.trash?"/force/":"/",t+=e.id,this.$api.delete(t,((e,t,a,l)=>{this.$Handle.successMessage(a),this.table.selected=[],this.refresh()}))}))},async restoreData(){this.loading=!0,await this.table.selected.forEach((e=>{let t=this.Meta.module;t+="/restore/",t+=e.id,this.$api.put(t,e,((e,t,a,l)=>{this.$Handle.successMessage(a),this.table.selected=[],this.refresh()}))}))},setTrash(){this.trash=JSON.parse(this.trash),this.trash=!this.trash,this.table.selected=[],this.table.search=null,this.table.pagination.page=1,this.table.pagination.rowsNumber=1,this.refresh()},detail(e){this.id=e,this.modalType="detail",!0===this.useModal.show?this.modal=!0:this.$router.push({params:{id:e},name:"view-"+this.Meta.module,query:{...this.$route.query}})},edit(e){this.modalType="form",!0===this.useModal.edit?(this.modal=!0,this.id=e):this.$router.push({params:{id:e},name:"edit-"+this.Meta.module,query:{...this.$route.query}})},addData(){this.modalType="form",!0===this.useModal.add?this.modal=!0:this.$router.push({name:"add-"+this.Meta.module,query:{...this.$route.query}})},submit(e){this.$Handle.loadingStart(),this.submitOnModal=e,this.refresh()},setFilter(){this.filter.value=!0},async getContentsGroup(){await this.$api.get(this.Meta.module+"/filter/group",((e,t)=>{200==t&&(this.group=e)}),(e=>{}))}}};var u=a(1639),b=a(7817),p=a(900),m=a(1227),g=a(7220),c=a(335),w=a(9984),y=a.n(w);const f=(0,u.Z)(d,[["render",i]]),$=f;y()(d,"components",{QTabs:b.Z,QTab:p.Z,QTable:m.Z,QTd:g.Z,QImg:c.Z})}}]);